import requests
import json
import lxml
import sys
import os

#from ebay_rare_item_search.settings import BASE_DIR
#sys.path.append(os.path.join(BASE_DIR, 'ebay_api/modules'))
from ebay_api_calls import findItemsAdvanced, findItemsByProduct


def uniqueItemFilterByTitle(items, best_offer_only):
    
    filtered_items = []
    #have to put it back
    #best_offer_only = "true"
    #best_offer_only = "false"
    if best_offer_only != "both":
        item_filter = [
            {
                "name": "BestOfferOnly",
                "value": best_offer_only
            }
        ]

    page_number = "1"
    entries_per_page = "10"
    pagination_input = {
        "entriesPerPage": entries_per_page,
        "pageNumber"    : page_number
    }

    rare_item_count = 0
    searched_item_count = len(items)
    for item in items:
        count = 0
        title = item["title"][0]
        # have to put back
        #title = item["title"]
        print("title: {}".format(title))
        if best_offer_only != "both":
            response = findItemsAdvanced(title, itemFilter=item_filter, paginationInput=pagination_input)
        else:
            response = findItemsAdvanced(title, paginationInput=pagination_input)
        print("response: {}".format(response))
        data = json.loads(response.decode('utf-8'))

        #if 'paginationOutput' in data['findItemsAdvancedResponse'][0]:
        total_entries = int(data['findItemsAdvancedResponse'][0]['paginationOutput'][0]['totalEntries'][0])
        print("total_entries: {}".format(total_entries))

        if total_entries > 0:
            found_items = data['findItemsAdvancedResponse'][0]['searchResult'][0]['item']
        
            for found_item in found_items:
                found_title = found_item["title"][0]
                if title == found_title:
                    count += 1

        #if total_entries <= 1:
        #    filtered_items.append(item)
        if count <= 1:
            filtered_items.append(item)
            rare_item_count+= 1
            print("RARE ITEM FOUND!: TOTAL: {} OUT OF {}".format(rare_item_count, searched_item_count))

        print("exact match results: {}".format(count))
            
    return filtered_items


def uniqueItemFilterByProductId(items, best_offer_only):
    
    filtered_items = []
    
    #best_offer_only = "true"
    if best_offer_only != "both":
        item_filter = [
            {
                "name": "BestOfferOnly",
                "value": best_offer_only
            }
        ]

    page_number = "1"
    entries_per_page = "10"
    pagination_input = {
        "entriesPerPage": entries_per_page,
        "pageNumber"    : page_number
    }

    for item in items:
        if "productId" in item:
            product_id = item["productId"][0]["__value__"]
            # have to put this part back
            #product_id = item["productId"]["__value__"]
            #product_id = "53039031"
            print("product id: {}".format(product_id))
            if best_offer_only != "both":
                response = findItemsByProduct(product_id, itemFilter=item_filter, paginationInput=pagination_input)
            else:
                response = findItemsByProduct(product_id, paginationInput=pagination_input)
            print(response)
            data = json.loads(response.decode('utf-8'))

            total_entries = int(data['findItemsByProductResponse'][0]['paginationOutput'][0]['totalEntries'][0])
            print("total_entries: {}".format(total_entries))

            if total_entries <= 1:
                filtered_items.append(item)
    
    return filtered_items


if __name__ == "__main__":
    
    '''items = uniqueItemFilterByProductId([{'itemId': '313742249885', 'title': 'Intel Core i5-11400 - 2.6 GHz 6-Core (BX8070811400) Processor', 'globalId': ['EBAY-US'], 'primaryCategory': [{'categoryId': ['164'], 'categoryName': ['CPUs/Processors']}], 'galleryURL': 'https://i.ebayimg.com/thumbs/images/g/9xAAAOSwB4VhSHrL/s-l140.jpg', 'viewItemURL': 'https://www.ebay.com/itm/Intel-Core-i5-11400-2-6-GHz-6-Core-BX8070811400-Processor-/313742249885', 'productId': [{'@type': 'ReferenceID', '__value__': '24047054962'}], 'autoPay': ['false'], 'postalCode': ['300**'], 'location': ['Marietta,GA,USA'], 'country': ['US'], 'shippingInfo': [{'shippingType': ['Calculated'], 'shipToLocations': ['Worldwide'], 'expeditedShipping': ['false'], 'oneDayShippingAvailable': ['false'], 'handlingTime': ['3']}], 'sellingStatus': [{'currentPrice': [{'@currencyId': 'USD', '__value__': '170.0'}], 'convertedCurrentPrice': [{'@currencyId': 'USD', '__value__': '170.0'}], 'sellingState': ['Active'], 'timeLeft': ['P29DT19H39M35S']}], 'listingInfo': [{'bestOfferEnabled': ['true'], 'buyItNowAvailable': ['false'], 'startTime': ['2021-11-06T23:28:55.000Z'], 'endTime': ['2021-12-06T23:28:55.000Z'], 'listingType': ['FixedPrice'], 'gift': ['false'], 'watchCount': ['2']}], 'returnsAccepted': ['true'], 'condition': [{'conditionId': ['3000'], 'conditionDisplayName': ['Used']}], 'isMultiVariationListing': ['false'], 'topRatedListing': ['false']}, {'itemId': '144278578769', 'title': 'Apple 1st Generation Pencil - White', 'globalId': ['EBAY-US'], 'primaryCategory': [{'categoryId': ['176981'], 'categoryName': ['Styluses']}], 'galleryURL': 'https://i.ebayimg.com/thumbs/images/g/w6EAAOSwobdhaz~k/s-l140.jpg', 'viewItemURL': 'https://www.ebay.com/itm/Apple-1st-Generation-Pencil-White-/144278578769', 'productId': [{'@type': 'ReferenceID', '__value__': '4048951412'}], 'autoPay': ['true'], 'postalCode': ['750**'], 'location': ['Coppell,TX,USA'], 'country': ['US'], 'shippingInfo': [{'shippingType': ['Calculated'], 'shipToLocations': ['Worldwide'], 'expeditedShipping': ['false'], 'oneDayShippingAvailable': ['false'], 'handlingTime': ['3']}], 'sellingStatus': [{'currentPrice': [{'@currencyId': 'USD', '__value__': '50.0'}], 'convertedCurrentPrice': [{'@currencyId': 'USD', '__value__': '50.0'}], 'sellingState': ['Active'], 'timeLeft': ['P28DT19H52M21S']}], 'listingInfo': [{'bestOfferEnabled': ['true'], 'buyItNowAvailable': ['false'], 'startTime': ['2021-11-06T23:41:48.000Z'], 'endTime': ['2021-12-05T23:41:41.000Z'], 'listingType': ['FixedPrice'], 'gift': ['false'], 'watchCount': ['2']}], 'returnsAccepted': ['false'], 'condition': [{'conditionId': ['3000'], 'conditionDisplayName': ['Used']}], 'isMultiVariationListing': ['false'], 'topRatedListing': ['false']}, {'itemId': '203687100868', 'title': 'NETGEAR AT&T Unite Pro 781S Wi-Fi Mobile Hotspot Fully Kitted Out (AT&T)', 'globalId': ['EBAY-US'], 'primaryCategory': [{'categoryId': ['175710'], 'categoryName': ['Mobile Broadband Devices']}], 'galleryURL': 'https://i.ebayimg.com/thumbs/images/g/Be8AAOSwsvFhWk11/s-l140.jpg', 'viewItemURL': 'https://www.ebay.com/itm/NETGEAR-AT-T-Unite-Pro-781S-Wi-Fi-Mobile-Hotspot-Fully-Kitted-Out-AT-T-/203687100868', 'productId': [{'@type': 'ReferenceID', '__value__': '16011555200'}], 'autoPay': ['true'], 'postalCode': ['119**'], 'location': ['Ridge,NY,USA'], 'country': ['US'], 'shippingInfo': [{'shippingServiceCost': [{'@currencyId': 'USD', '__value__': '0.0'}], 'shippingType': ['Free'], 'shipToLocations': ['Worldwide'], 'expeditedShipping': ['true'], 'oneDayShippingAvailable': ['false'], 'handlingTime': ['1']}], 'sellingStatus': [{'currentPrice': [{'@currencyId': 'USD', '__value__': '43.69'}], 'convertedCurrentPrice': [{'@currencyId': 'USD', '__value__': '43.69'}], 'sellingState': ['Active'], 'timeLeft': ['P28DT17H4M18S']}], 'listingInfo': [{'bestOfferEnabled': ['true'], 'buyItNowAvailable': ['false'], 'startTime': ['2021-11-05T20:53:38.000Z'], 'endTime': ['2021-12-05T20:53:38.000Z'], 'listingType': ['FixedPrice'], 'gift': ['false'], 'watchCount': ['3']}], 'returnsAccepted': ['true'], 'condition': [{'conditionId': ['1500'], 'conditionDisplayName': ['Open box']}], 'isMultiVariationListing': ['false'], 'topRatedListing': ['true']}, {'itemId': '185150296527', 'title': 'Amazon Kindle Oasis (9th Generation) 8GB, Wi-Fi, 7in - Graphite with Amazon', 'globalId': ['EBAY-US'], 'primaryCategory': [{'categoryId': ['171485'], 'categoryName': ['Tablets & eBook Readers']}], 'galleryURL': 'https://i.ebayimg.com/thumbs/images/g/nC4AAOSwbBphhztu/s-l140.jpg', 'viewItemURL': 'https://www.ebay.com/itm/Amazon-Kindle-Oasis-9th-Generation-8GB-Wi-Fi-7in-Graphite-Amazon-/185150296527', 'productId': [{'@type': 'ReferenceID', '__value__': '239166707'}], 'autoPay': ['true'], 'postalCode': ['144**'], 'location': ['Fairport,NY,USA'], 'country': ['US'], 'shippingInfo': [{'shippingType': ['Calculated'], 'shipToLocations': ['Worldwide'], 'expeditedShipping': ['true'], 'oneDayShippingAvailable': ['false'], 'handlingTime': ['1']}], 'sellingStatus': [{'currentPrice': [{'@currencyId': 'USD', '__value__': '140.0'}], 'convertedCurrentPrice': [{'@currencyId': 'USD', '__value__': '140.0'}], 'sellingState': ['Active'], 'timeLeft': ['P29DT22H48M34S']}], 'listingInfo': [{'bestOfferEnabled': ['true'], 'buyItNowAvailable': ['false'], 'startTime': ['2021-11-07T02:37:54.000Z'], 'endTime': ['2021-12-07T02:37:54.000Z'], 'listingType': ['FixedPrice'], 'gift': ['false'], 'watchCount': ['1']}], 'returnsAccepted': ['true'], 'condition': [{'conditionId': ['3000'], 'conditionDisplayName': ['Used']}], 'isMultiVariationListing': ['false'], 'topRatedListing': ['false']}, {'itemId': '255209818200', 'title': 'TN014 TN-014 A3VV130 Genuine Konica Minolta Toner For Pro 1250 1052', 'globalId': ['EBAY-US'], 'primaryCategory': [{'categoryId': ['16204'], 'categoryName': ['Toner Cartridges']}], 'galleryURL': 'https://i.ebayimg.com/thumbs/images/g/eAAAAOSwaXthgCPU/s-l140.jpg', 'viewItemURL': 'https://www.ebay.com/itm/TN014-TN-014-A3VV130-Genuine-Konica-Minolta-Toner-Pro-1250-1052-/255209818200', 'productId': [{'@type': 'ReferenceID', '__value__': '1400797014'}], 'autoPay': ['true'], 'postalCode': ['640**'], 'location': ['Blue Springs,MO,USA'], 'country': ['US'], 'shippingInfo': [{'shippingType': ['Calculated'], 'shipToLocations': ['Worldwide'], 'expeditedShipping': ['true'], 'oneDayShippingAvailable': ['false'], 'handlingTime': ['1']}], 'sellingStatus': [{'currentPrice': [{'@currencyId': 'USD', '__value__': '325.0'}], 'convertedCurrentPrice': [{'@currencyId': 'USD', '__value__': '325.0'}], 'sellingState': ['Active'], 'timeLeft': ['P26DT8H19M39S']}], 'listingInfo': [{'bestOfferEnabled': ['true'], 'buyItNowAvailable': ['false'], 'startTime': ['2021-11-03T12:08:59.000Z'], 'endTime': ['2021-12-03T12:08:59.000Z'], 'listingType': ['FixedPrice'], 'gift': ['false'], 'watchCount': ['2']}], 'returnsAccepted': ['false'], 'condition': [{'conditionId': ['1000'], 'conditionDisplayName': ['New']}], 'isMultiVariationListing': ['false'], 'topRatedListing': ['false']}, {'itemId': '194224085439', 'title': 'Apple MLA22LL/A Magic Keyboard 2 - Silver', 'globalId': ['EBAY-US'], 'subtitle': ['ðŸ”¥EXCELLENT CONDITIONðŸ”¥'], 'primaryCategory': [{'categoryId': ['33963'], 'categoryName': ['Keyboards & Keypads']}], 'galleryURL': 'https://i.ebayimg.com/thumbs/images/g/HfMAAOSw9ythbvar/s-l140.jpg', 'viewItemURL': 'https://www.ebay.com/itm/Apple-MLA22LL-A-Magic-Keyboard-2-Silver-/194224085439', 'productId': [{'@type': 'ReferenceID', '__value__': '25026719178'}], 'autoPay': ['true'], 'postalCode': ['334**'], 'location': ['Boca Raton,FL,USA'], 'country': ['US'], 'shippingInfo': [{'shippingServiceCost': [{'@currencyId': 'USD', '__value__': '0.0'}], 'shippingType': ['Free'], 'shipToLocations': ['Worldwide'], 'expeditedShipping': ['true'], 'oneDayShippingAvailable': ['true'], 'handlingTime': ['0']}], 'sellingStatus': [{'currentPrice': [{'@currencyId': 'USD', '__value__': '59.99'}], 'convertedCurrentPrice': [{'@currencyId': 'USD', '__value__': '59.99'}], 'sellingState': ['Active'], 'timeLeft': ['P24DT16H55M1S']}], 'listingInfo': [{'bestOfferEnabled': ['true'], 'buyItNowAvailable': ['false'], 'startTime': ['2021-07-01T20:44:21.000Z'], 'endTime': ['2021-12-01T20:44:21.000Z'], 'listingType': ['FixedPrice'], 'gift': ['false'], 'watchCount': ['20']}], 'returnsAccepted': ['true'], 'condition': [{'conditionId': ['1500'], 'conditionDisplayName': ['Open box']}], 'isMultiVariationListing': ['false'], 'topRatedListing': ['false']}, {'itemId': '284517792085', 'title': 'Glorious PC Gaming Race O- (GOMGWHITE1) Wired Mouse', 'globalId': ['EBAY-US'], 'primaryCategory': [{'categoryId': ['23160'], 'categoryName': ['Mice, Trackballs & Touchpads']}], 'galleryURL': 'https://i.ebayimg.com/thumbs/images/g/KJUAAOSwZnBhhWIp/s-l140.jpg', 'viewItemURL': 'https://www.ebay.com/itm/Glorious-PC-Gaming-Race-O-GOMGWHITE1-Wired-Mouse-/284517792085', 'productId': [{'@type': 'ReferenceID', '__value__': '19036322673'}], 'autoPay': ['true'], 'postalCode': ['112**'], 'location': ['Brooklyn,NY,USA'], 'country': ['US'], 'shippingInfo': [{'shippingType': ['Calculated'], 'shipToLocations': ['Worldwide'], 'expeditedShipping': ['false'], 'oneDayShippingAvailable': ['false'], 'handlingTime': ['3']}], 'sellingStatus': [{'currentPrice': [{'@currencyId': 'USD', '__value__': '26.0'}], 'convertedCurrentPrice': [{'@currencyId': 'USD', '__value__': '26.0'}], 'sellingState': ['Active'], 'timeLeft': ['P28DT13H7M52S']}], 'listingInfo': [{'bestOfferEnabled': ['true'], 'buyItNowAvailable': ['false'], 'startTime': ['2021-11-06T16:57:14.000Z'], 'endTime': ['2021-12-05T16:57:12.000Z'], 'listingType': ['FixedPrice'], 'gift': ['false'], 'watchCount': ['1']}], 'returnsAccepted': ['false'], 'condition': [{'conditionId': ['3000'], 'conditionDisplayName': ['Used']}], 'isMultiVariationListing': ['false'], 'topRatedListing': ['false']}, {'itemId': '353758072470', 'title': 'Windows 10 Home 32/64 Bit English USB Flash Drive New Sealed', 'globalId': ['EBAY-US'], 'primaryCategory': [{'categoryId': ['11226'], 'categoryName': ['Operating Systems']}], 'galleryURL': 'https://i.ebayimg.com/thumbs/images/g/zXMAAOSwAcBhhWci/s-l140.jpg', 'viewItemURL': 'https://www.ebay.com/itm/Windows-10-Home-32-64-Bit-English-USB-Flash-Drive-New-Sealed-/353758072470', 'productId': [{'@type': 'ReferenceID', '__value__': '245926133'}], 'autoPay': ['true'], 'postalCode': ['407**'], 'location': ['East Bernstadt,KY,USA'], 'country': ['US'], 'shippingInfo': [{'shippingServiceCost': [{'@currencyId': 'USD', '__value__': '0.0'}], 'shippingType': ['Free'], 'shipToLocations': ['Worldwide'], 'expeditedShipping': ['false'], 'oneDayShippingAvailable': ['false'], 'handlingTime': ['3']}], 'sellingStatus': [{'currentPrice': [{'@currencyId': 'USD', '__value__': '42.0'}], 'convertedCurrentPrice': [{'@currencyId': 'USD', '__value__': '42.0'}], 'sellingState': ['Active'], 'timeLeft': ['P28DT13H29M6S']}], 'listingInfo': [{'bestOfferEnabled': ['true'], 'buyItNowAvailable': ['false'], 'startTime': ['2021-11-06T17:18:28.000Z'], 'endTime': ['2021-12-05T17:18:26.000Z'], 'listingType': ['FixedPrice'], 'gift': ['false'], 'watchCount': ['2']}], 'returnsAccepted': ['false'], 'condition': [{'conditionId': ['1000'], 'conditionDisplayName': ['Brand New']}], 'isMultiVariationListing': ['false'], 'topRatedListing': ['false']}, {'itemId': '124916327813', 'title': 'Netgear Nighthawk C7000 AC1900 Dual-Band Built-in DOCSIS 3.0 Cable Modem Router', 'globalId': ['EBAY-US'], 'primaryCategory': [{'categoryId': ['44995'], 'categoryName': ['Wireless Routers']}], 'galleryURL': 'https://i.ebayimg.com/thumbs/images/g/P-gAAOSw8EVhTN66/s-l140.jpg', 'viewItemURL': 'https://www.ebay.com/itm/Netgear-Nighthawk-C7000-AC1900-Dual-Band-Built-in-DOCSIS-3-0-Cable-Modem-Router-/124916327813', 'productId': [{'@type': 'ReferenceID', '__value__': '222714264'}], 'autoPay': ['false'], 'postalCode': ['900**'], 'location': ['Los Angeles,CA,USA'], 'country': ['US'], 'shippingInfo': [{'shippingServiceCost': [{'@currencyId': 'USD', '__value__': '0.0'}], 'shippingType': ['Free'], 'shipToLocations': ['Worldwide'], 'expeditedShipping': ['false'], 'oneDayShippingAvailable': ['false'], 'handlingTime': ['1']}], 'sellingStatus': [{'currentPrice': [{'@currencyId': 'USD', '__value__': '109.99'}], 'convertedCurrentPrice': [{'@currencyId': 'USD', '__value__': '109.99'}], 'sellingState': ['Active'], 'timeLeft': ['P16DT16H24M5S']}], 'listingInfo': [{'bestOfferEnabled': ['true'], 'buyItNowAvailable': ['false'], 'startTime': ['2021-09-23T20:13:25.000Z'], 'endTime': ['2021-11-23T20:13:25.000Z'], 'listingType': ['FixedPrice'], 'gift': ['false'], 'watchCount': ['27']}], 'returnsAccepted': ['true'], 'condition': [{'conditionId': ['1500'], 'conditionDisplayName': ['Open box']}], 'isMultiVariationListing': ['false'], 'topRatedListing': ['false']}])

    print(items)
    print(len(items))'''

    '''items = uniqueItemFilterByTitle([{'itemId': '124791322269', 'title': 'Early punched tin foot warmer, heart design', 'globalId': ['EBAY-US'], 'primaryCategory': {'categoryId': ['1217'], 'categoryName': 'Primitives'}, 'galleryURL': 'https://i.ebayimg.com/thumbs/images/g/JHgAAOSwtkNg2vrx/s-l140.jpg', 'viewItemURL': 'https://www.ebay.com/itm/Early-punched-tin-foot-warmer-heart-design-/124791322269', 'autoPay': ['false'], 'postalCode': ['025**'], 'location': ['North Falmouth,MA,USA'], 'country': ['US'], 'shippingInfo': [{'shippingType': ['Calculated'], 'shipToLocations': ['Worldwide'], 'expeditedShipping': ['true'], 'oneDayShippingAvailable': ['false'], 'handlingTime': ['3']}], 'sellingStatus': [{'currentPrice': [{'@currencyId': 'USD', '__value__': '100.0'}], 'convertedCurrentPrice': [{'@currencyId': 'USD', '__value__': '100.0'}], 'sellingState': ['Active'], 'timeLeft': ['P13DT5H20M35S']}], 'listingInfo': {'bestOfferEnabled': ['true'], 'buyItNowAvailable': ['false'], 'startTime': ['2021-06-29T10:54:14.000Z'], 'endTime': ['2021-11-29T10:54:14.000Z'], 'listingType': 'FixedPrice', 'gift': ['false'], 'watchCount': ['1']}, 'returnsAccepted': ['true'], 'isMultiVariationListing': ['false'], 'topRatedListing': ['false']}, {'itemId': '393702618249', 'title': 'Rare Soviet Book Zoshchenko M., Radlov N."Merry Projects".(30 Lucky Ideas) 1928', 'globalId': ['EBAY-US'], 'primaryCategory': {'categoryId': ['12'], 'categoryName': 'Other Antiques'}, 'galleryURL': 'https://i.ebayimg.com/thumbs/images/g/LZ8AAOSw1V9gDxXo/s-l140.jpg', 'viewItemURL': 'https://www.ebay.com/itm/Rare-Soviet-Book-Zoshchenko-M-Radlov-N-Merry-Projects-30-Lucky-Ideas-1928-/393702618249', 'autoPay': ['false'], 'location': ['Russian Federation'], 'country': ['RU'], 'shippingInfo': [{'shippingServiceCost': [{'@currencyId': 'USD', '__value__': '25.0'}], 'shippingType': ['Flat'], 'shipToLocations': ['Worldwide'], 'expeditedShipping': ['false'], 'oneDayShippingAvailable': ['false'], 'handlingTime': ['30']}], 'sellingStatus': [{'currentPrice': [{'@currencyId': 'USD', '__value__': '350.0'}], 'convertedCurrentPrice': [{'@currencyId': 'USD', '__value__': '350.0'}], 'sellingState': ['Active'], 'timeLeft': ['P29DT10H33M3S']}], 'listingInfo': {'bestOfferEnabled': ['true'], 'buyItNowAvailable': ['false'], 'startTime': ['2021-11-15T16:06:42.000Z'], 'endTime': ['2021-12-15T16:06:42.000Z'], 'listingType': 'FixedPrice', 'gift': ['false']}, 'returnsAccepted': ['true'], 'isMultiVariationListing': ['false'], 'topRatedListing': ['false']}, {'itemId': '363623295453', 'title': 'Antique Fairbanks Two Wheel Orchard Cart and Two Fruit Boxes', 'globalId': ['EBAY-US'], 'primaryCategory': {'categoryId': ['1217'], 'categoryName': 'Primitives'}, 'galleryURL': 'https://i.ebayimg.com/thumbs/images/g/xywAAOSwfAxhgIO7/s-l140.jpg', 'viewItemURL': 'https://www.ebay.com/itm/Antique-Fairbanks-Two-Wheel-Orchard-Cart-and-Two-Fruit-Boxes-/363623295453', 'autoPay': ['false'], 'postalCode': ['974**'], 'location': ['Roseburg,OR,USA'], 'country': ['US'], 'shippingInfo': [{'shippingServiceCost': [{'@currencyId': 'USD', '__value__': '0.0'}], 'shippingType': ['FreePickup'], 'shipToLocations': ['Worldwide'], 'expeditedShipping': ['false'], 'oneDayShippingAvailable': ['false']}], 'sellingStatus': [{'currentPrice': [{'@currencyId': 'USD', '__value__': '375.0'}], 'convertedCurrentPrice': [{'@currencyId': 'USD', '__value__': '375.0'}], 'bidCount': ['0'], 'sellingState': ['Active'], 'timeLeft': ['P4DT20H29M8S']}], 'listingInfo': {'bestOfferEnabled': ['true'], 'buyItNowAvailable': ['false'], 'startTime': ['2021-11-16T02:02:47.000Z'], 'endTime': ['2021-11-21T02:02:47.000Z'], 'listingType': 'Auction', 'gift': ['false']}, 'returnsAccepted': ['false'], 'isMultiVariationListing': ['false'], 'topRatedListing': ['false']}, {'itemId': '255229611539', 'title': 'Persian ghalamkar handmade natural dye tablecloth block hand printed calico art', 'globalId': ['EBAY-GB'], 'primaryCategory': {'categoryId': ['116556'], 'categoryName': 'Islamic/Middle Eastern'}, 'galleryURL': 'https://i.ebayimg.com/thumbs/images/g/Gr0AAOSwSzNgx7Qq/s-l140.jpg', 'viewItemURL': 'https://www.ebay.com/itm/Persian-ghalamkar-handmade-natural-dye-tablecloth-block-hand-printed-calico-art-/255229611539', 'autoPay': ['true'], 'location': ['Turkey'], 'country': ['TR'], 'shippingInfo': [{'shippingServiceCost': [{'@currencyId': 'USD', '__value__': '0.0'}], 'shippingType': ['Free'], 'shipToLocations': ['Worldwide'], 'expeditedShipping': ['false'], 'oneDayShippingAvailable': ['false'], 'handlingTime': ['30']}], 'sellingStatus': [{'currentPrice': [{'@currencyId': 'GBP', '__value__': '69.95'}], 'convertedCurrentPrice': [{'@currencyId': 'USD', '__value__': '93.7'}], 'sellingState': ['Active'], 'timeLeft': ['P29DT10H0M52S']}], 'listingInfo': {'bestOfferEnabled': ['true'], 'buyItNowAvailable': ['false'], 'startTime': ['2021-11-15T15:34:31.000Z'], 'endTime': ['2021-12-15T15:34:31.000Z'], 'listingType': 'FixedPrice', 'gift': ['false']}, 'returnsAccepted': ['false'], 'isMultiVariationListing': ['false'], 'topRatedListing': ['false']}, {'itemId': '154701814766', 'title': 'Antique Metal Candelstick Holder', 'globalId': ['EBAY-GB'], 'primaryCategory': {'categoryId': ['358'], 'categoryName': 'Other Metalware'}, 'galleryURL': 'https://i.ebayimg.com/thumbs/images/g/iiYAAOSwQilhAuOF/s-l140.jpg', 'viewItemURL': 'https://www.ebay.com/itm/Antique-Metal-Candelstick-Holder-/154701814766', 'autoPay': ['false'], 'postalCode': ['FK150EE'], 'location': ['United Kingdom'], 'country': ['GB'], 'shippingInfo': [{'shippingType': ['Flat'], 'shipToLocations': ['Worldwide'], 'expeditedShipping': ['false'], 'oneDayShippingAvailable': ['false'], 'handlingTime': ['2']}], 'sellingStatus': [{'currentPrice': [{'@currencyId': 'GBP', '__value__': '24.99'}], 'convertedCurrentPrice': [{'@currencyId': 'USD', '__value__': '33.47'}], 'bidCount': ['0'], 'sellingState': ['Active'], 'timeLeft': ['P6DT7H52M15S']}], 'listingInfo': {'bestOfferEnabled': ['true'], 'buyItNowAvailable': ['false'], 'startTime': ['2021-11-15T13:25:54.000Z'], 'endTime': ['2021-11-22T13:25:54.000Z'], 'listingType': 'Auction', 'gift': ['false']}, 'returnsAccepted': ['false'], 'isMultiVariationListing': ['false'], 'topRatedListing': ['false']}, {'itemId': '175021392155', 'title': '2 XL Maine vintage Lobster Trap Pot Buoy Floats/Cape Cod/MAINE Nautical gifts', 'globalId': ['EBAY-US'], 'primaryCategory': {'categoryId': ['37968'], 'categoryName': 'Fishing Nets & Floats'}, 'galleryURL': 'https://i.ebayimg.com/thumbs/images/g/WqsAAOSwMm1hkDa1/s-l140.jpg', 'viewItemURL': 'https://www.ebay.com/itm/2-XL-Maine-vintage-Lobster-Trap-Pot-Buoy-Floats-Cape-Cod-MAINE-Nautical-gifts-/175021392155', 'autoPay': ['true'], 'postalCode': ['042**'], 'location': ['Monmouth,ME,USA'], 'country': ['US'], 'shippingInfo': [{'shippingServiceCost': [{'@currencyId': 'USD', '__value__': '0.0'}], 'shippingType': ['FreePickup'], 'shipToLocations': ['Worldwide'], 'expeditedShipping': ['true'], 'oneDayShippingAvailable': ['false'], 'handlingTime': ['1']}], 'sellingStatus': [{'currentPrice': [{'@currencyId': 'USD', '__value__': '50.0'}], 'convertedCurrentPrice': [{'@currencyId': 'USD', '__value__': '50.0'}], 'sellingState': ['Active'], 'timeLeft': ['P27DT17H29M51S']}], 'listingInfo': {'bestOfferEnabled': ['true'], 'buyItNowAvailable': ['false'], 'startTime': ['2021-11-13T23:03:30.000Z'], 'endTime': ['2021-12-13T23:03:30.000Z'], 'listingType': 'FixedPrice', 'gift': ['false'], 'watchCount': ['1']}, 'returnsAccepted': ['false'], 'isMultiVariationListing': ['false'], 'topRatedListing': ['false']}, {'itemId': '193908185446', 'title': 'Antique Early Hand Forged Iron Caliper Blacksmith Made w/Unique Graduations NICE', 'globalId': ['EBAY-US'], 'primaryCategory': {'categoryId': ['1217'], 'categoryName': 'Primitives'}, 'galleryURL': 'https://i.ebayimg.com/thumbs/images/g/LPQAAOSwJstgMynX/s-l140.jpg', 'viewItemURL': 'https://www.ebay.com/itm/Antique-Early-Hand-Forged-Iron-Caliper-Blacksmith-Made-w-Unique-Graduations-NICE-/193908185446', 'autoPay': ['false'], 'postalCode': ['044**'], 'location': ['Mattawamkeag,ME,USA'], 'country': ['US'], 'shippingInfo': [{'shippingServiceCost': [{'@currencyId': 'USD', '__value__': '20.0'}], 'shippingType': ['Flat'], 'shipToLocations': ['Worldwide'], 'expeditedShipping': ['true'], 'oneDayShippingAvailable': ['false'], 'handlingTime': ['3']}], 'sellingStatus': [{'currentPrice': [{'@currencyId': 'USD', '__value__': '385.0'}], 'convertedCurrentPrice': [{'@currencyId': 'USD', '__value__': '385.0'}], 'sellingState': ['Active'], 'timeLeft': ['P5DT22H43M5S']}], 'listingInfo': {'bestOfferEnabled': ['true'], 'buyItNowAvailable': ['false'], 'startTime': ['2021-02-22T04:16:44.000Z'], 'endTime': ['2021-11-22T04:16:44.000Z'], 'listingType': 'StoreInventory', 'gift': ['false'], 'watchCount': ['3']}, 'returnsAccepted': ['true'], 'galleryPlusPictureURL': ['https://galleryplus.ebayimg.com/ws/web/193908185446_1_1_1.jpg'], 'isMultiVariationListing': ['false'], 'topRatedListing': ['false']}, {'itemId': '133935504493', 'title': "1 Vintage Hamilton Printer's Drawer . New Departure . VGC . 32 X 16.5 â€œ .", 'globalId': ['EBAY-US'], 'primaryCategory': {'categoryId': ['163093'], 'categoryName': 'Binding, Embossing & Printing'}, 'galleryURL': 'https://i.ebayimg.com/thumbs/images/g/jmAAAOSwgXhhkooc/s-l140.jpg', 'viewItemURL': 'https://www.ebay.com/itm/1-Vintage-Hamilton-Printers-Drawer-New-Departure-VGC-32-X-16-5-/133935504493', 'autoPay': ['false'], 'postalCode': ['750**'], 'location': ['Richardson,TX,USA'], 'country': ['US'], 'shippingInfo': [{'shippingType': ['Calculated'], 'shipToLocations': ['Worldwide'], 'expeditedShipping': ['true'], 'oneDayShippingAvailable': ['false'], 'handlingTime': ['1']}], 'sellingStatus': [{'currentPrice': [{'@currencyId': 'USD', '__value__': '150.0'}], 'convertedCurrentPrice': [{'@currencyId': 'USD', '__value__': '150.0'}], 'sellingState': ['Active'], 'timeLeft': ['P29DT11H0M51S']}], 'listingInfo': {'bestOfferEnabled': ['true'], 'buyItNowAvailable': ['false'], 'startTime': ['2021-11-15T16:34:30.000Z'], 'endTime': ['2021-12-15T16:34:30.000Z'], 'listingType': 'FixedPrice', 'gift': ['false']}, 'returnsAccepted': ['true'], 'isMultiVariationListing': ['false'], 'topRatedListing': ['false']}, {'itemId': '255229967573', 'title': 'Persian Ceramic Tile Hadith Nabawi Islamic Middle East Arabic Calligraphy Small', 'globalId': ['EBAY-GB'], 'primaryCategory': {'categoryId': ['116556'], 'categoryName': 'Islamic/Middle Eastern'}, 'galleryURL': 'https://i.ebayimg.com/thumbs/images/g/O7cAAOSwIgdf~Yev/s-l140.jpg', 'viewItemURL': 'https://www.ebay.com/itm/Persian-Ceramic-Tile-Hadith-Nabawi-Islamic-Middle-East-Arabic-Calligraphy-Small-/255229967573', 'autoPay': ['true'], 'location': ['Turkey'], 'country': ['TR'], 'shippingInfo': [{'shippingServiceCost': [{'@currencyId': 'USD', '__value__': '0.0'}], 'shippingType': ['Free'], 'shipToLocations': ['Worldwide'], 'expeditedShipping': ['false'], 'oneDayShippingAvailable': ['false'], 'handlingTime': ['30']}], 'sellingStatus': [{'currentPrice': [{'@currencyId': 'GBP', '__value__': '49.95'}], 'convertedCurrentPrice': [{'@currencyId': 'USD', '__value__': '66.91'}], 'sellingState': ['Active'], 'timeLeft': ['P29DT14H40M36S']}], 'listingInfo': {'bestOfferEnabled': ['true'], 'buyItNowAvailable': ['false'], 'startTime': ['2021-11-15T20:14:15.000Z'], 'endTime': ['2021-12-15T20:14:15.000Z'], 'listingType': 'FixedPrice', 'gift': ['false']}, 'returnsAccepted': ['false'], 'isMultiVariationListing': ['false'], 'topRatedListing': ['false']}, {'itemId': '393702605487', 'title': '"USSR in Construction" magazine No.1 1932 "giant" and "builder .Troshin .', 'globalId': ['EBAY-US'], 'primaryCategory': {'categoryId': ['12'], 'categoryName': 'Other Antiques'}, 'galleryURL': 'https://i.ebayimg.com/thumbs/images/g/kBYAAOSwQsdgZJh~/s-l140.jpg', 'viewItemURL': 'https://www.ebay.com/itm/USSR-Construction-magazine-No-1-1932-giant-and-builder-Troshin-/393702605487', 'autoPay': ['false'], 'location': ['Russian Federation'], 'country': ['RU'], 'shippingInfo': [{'shippingServiceCost': [{'@currencyId': 'USD', '__value__': '25.0'}], 'shippingType': ['Flat'], 'shipToLocations': ['Worldwide'], 'expeditedShipping': ['false'], 'oneDayShippingAvailable': ['false'], 'handlingTime': ['30']}], 'sellingStatus': [{'currentPrice': [{'@currencyId': 'USD', '__value__': '320.0'}], 'convertedCurrentPrice': [{'@currencyId': 'USD', '__value__': '320.0'}], 'sellingState': ['Active'], 'timeLeft': ['P29DT10H20M21S']}], 'listingInfo': {'bestOfferEnabled': ['true'], 'buyItNowAvailable': ['false'], 'startTime': ['2021-11-15T15:54:00.000Z'], 'endTime': ['2021-12-15T15:54:00.000Z'], 'listingType': 'FixedPrice', 'gift': ['false']}, 'returnsAccepted': ['true'], 'isMultiVariationListing': ['false'], 'topRatedListing': ['false']}])'''

    #items = uniqueItemFilterByTitle([{'itemId': '154701814766', 'title': 'Antique Metal Candelstick Holder', 'globalId': ['EBAY-GB'], 'primaryCategory': {'categoryId': ['358'], 'categoryName': 'Other Metalware'}, 'galleryURL': 'https://i.ebayimg.com/thumbs/images/g/iiYAAOSwQilhAuOF/s-l140.jpg', 'viewItemURL': 'https://www.ebay.com/itm/Antique-Metal-Candelstick-Holder-/154701814766', 'autoPay': ['false'], 'postalCode': ['FK150EE'], 'location': ['United Kingdom'], 'country': ['GB'], 'shippingInfo': [{'shippingType': ['Flat'], 'shipToLocations': ['Worldwide'], 'expeditedShipping': ['false'], 'oneDayShippingAvailable': ['false'], 'handlingTime': ['2']}], 'sellingStatus': [{'currentPrice': [{'@currencyId': 'GBP', '__value__': '24.99'}], 'convertedCurrentPrice': [{'@currencyId': 'USD', '__value__': '33.47'}], 'bidCount': ['0'], 'sellingState': ['Active'], 'timeLeft': ['P6DT7H52M15S']}], 'listingInfo': {'bestOfferEnabled': ['true'], 'buyItNowAvailable': ['false'], 'startTime': ['2021-11-15T13:25:54.000Z'], 'endTime': ['2021-11-22T13:25:54.000Z'], 'listingType': 'Auction', 'gift': ['false']}, 'returnsAccepted': ['false'], 'isMultiVariationListing': ['false'], 'topRatedListing': ['false']}])


    items = uniqueItemFilterByProductId([{'itemId': '194509150405', 'title': 'Sabian 12" HH Splash', 'globalId': ['EBAY-US'], 'primaryCategory': {'categoryId': ['41441'], 'categoryName': 'Cymbals'}, 'galleryURL': 'https://i.ebayimg.com/thumbs/images/g/jKQAAOSwHcFhlLvv/s-l140.jpg', 'viewItemURL': 'https://www.ebay.com/itm/Sabian-12-HH-Splash-/194509150405', 'productId': [{'@type': 'ReferenceID', '__value__': '78701791'}], 'autoPay': ['false'], 'postalCode': ['292**'], 'location': ['Columbia,SC,USA'], 'country': ['US'], 'shippingInfo': [{'shippingServiceCost': [{'@currencyId': 'USD', '__value__': '0.0'}], 'shippingType': ['Free'], 'shipToLocations': ['Worldwide'], 'expeditedShipping': ['false'], 'oneDayShippingAvailable': ['false'], 'handlingTime': ['2']}], 'sellingStatus': [{'currentPrice': [{'@currencyId': 'USD', '__value__': '209.99'}], 'convertedCurrentPrice': [{'@currencyId': 'USD', '__value__': '209.99'}], 'sellingState': ['Active'], 'timeLeft': ['P28DT23H37M1S']}], 'listingInfo': {'bestOfferEnabled': ['false'], 'buyItNowAvailable': ['false'], 'startTime': ['2021-11-17T08:23:13.000Z'], 'endTime': ['2021-12-17T08:23:13.000Z'], 'listingType': 'FixedPrice', 'gift': ['false']}, 'returnsAccepted': ['false'], 'condition': {'conditionId': ['1000'], 'conditionDisplayName': 'New'}, 'isMultiVariationListing': ['false'], 'topRatedListing': ['false'], 'product_id': '78701791'}, {'itemId': '293747060560', 'title': 'RME Babysface Pro FS Audio Interface', 'globalId': ['EBAY-US'], 'primaryCategory': {'categoryId': ['123445'], 'categoryName': 'Audio/MIDI Interfaces'}, 'galleryURL': 'https://i.ebayimg.com/thumbs/images/g/0ooAAOSwtxNg91Pn/s-l140.jpg', 'viewItemURL': 'https://www.ebay.com/itm/RME-Babysface-Pro-FS-Audio-Interface-/293747060560', 'productId': [{'@type': 'ReferenceID', '__value__': '28036064359'}], 'autoPay': ['true'], 'postalCode': ['089**'], 'location': ['North Brunswick,NJ,USA'], 'country': ['US'], 'shippingInfo': [{'shippingServiceCost': [{'@currencyId': 'USD', '__value__': '0.0'}], 'shippingType': ['Free'], 'shipToLocations': ['Worldwide'], 'expeditedShipping': ['false'], 'oneDayShippingAvailable': ['false'], 'handlingTime': ['1']}], 'sellingStatus': [{'currentPrice': [{'@currencyId': 'USD', '__value__': '949.0'}], 'convertedCurrentPrice': [{'@currencyId': 'USD', '__value__': '949.0'}], 'sellingState': ['Active'], 'timeLeft': ['P3DT12H42M49S']}], 'listingInfo': {'bestOfferEnabled': ['true'], 'buyItNowAvailable': ['false'], 'startTime': ['2020-09-21T21:29:01.000Z'], 'endTime': ['2021-11-21T21:29:01.000Z'], 'listingType': 'FixedPrice', 'gift': ['false'], 'watchCount': ['7']}, 'returnsAccepted': ['true'], 'condition': {'conditionId': ['1000'], 'conditionDisplayName': 'New'}, 'isMultiVariationListing': ['false'], 'discountPriceInfo': [{'originalRetailPrice': [{'@currencyId': 'USD', '__value__': '999.0'}], 'pricingTreatment': ['STP'], 'soldOnEbay': ['false'], 'soldOffEbay': ['false']}], 'topRatedListing': ['true'], 'product_id': '28036064359'}], "false")
    print(items)
    print(len(items))


